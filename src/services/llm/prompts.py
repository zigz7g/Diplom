ANNOTATION_PROMPT_RU = """
Ты размечаешь одно срабатывание статического анализа. Говоришь только по делу и только по переданному коду.

Дано:
- Правило: {rule}
- Уровень: {level}
- Файл: {file}
- Строка: {line}
- Сообщение сканера: {message}

Фрагмент кода (snippet):
<<CODE>>
{snippet}
<<END>>

Контекст (усечённый текст файла):
<<CONTEXT>>
{file_text}
<<END>>

Инструкции:
1) Реши, есть ли в приведённом фрагменте реальный путь эксплуатации согласно правилу. Опирайся только на этот код.
2) Комментарий пиши кратко (2–4 предложения), с привязкой к строкам/токенам из кода. Без общих фраз про “нет source/sink”, “категорию none”, “непредоставлен контекст” и т.п.
3) Если это тест/дока/CI и из кода не видно прод-пути, лучше отклонить.
4) Верни строгий JSON без лишнего текста, ключи: 
   {{
     "status": "confirmed|false_positive",
     "severity": "critical|medium|low|info",
     "comment": "краткий разбор по коду",
     "label": "краткий тег (XSS|SQLi|HardcodedKey|InsecureConfig|…)",
     "confidence": 0.0-1.0
   }}

Только JSON.
"""
